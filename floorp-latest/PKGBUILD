# Maintainer: fuzakebito <fuzakebito[at]fuzake[dot]io>
_pkgname=floorp
pkgname=floorp-latest
pkgver=11.2.0
pkgrel=1
pkgdesc="Firefox-based browser with excellent privacy protection, developed by a community of students in Japan"
url="http://floorp.ablaze.one"
arch=('x86_64' 'aarch64')
license=('MPL2')
depends=('gtk3' 'libxt' 'mime-types' 'dbus-glib' 'nss' 'ttf-font')
optdepends=('ffmpeg: H264/AAC/MP3 decoding'
            'networkmanager: Location detection via available WiFi networks'
            'libnotify: Notification integration'
            'pulseaudio: Audio support'
            'speech-dispatcher: Text-to-Speech'
            'hunspell-en_US: Spell checking, American English')
makedepends=('imagemagick')
conflicts=("$_pkgname")
replaces=()
backup=()
source=("https://github.com/Floorp-Projects/About-Floorp-Projects/raw/main/Creater-pack/Creater_pack_Floorp.zip"
            "floorp.desktop")
source_x86_64=("https://github.com/Floorp-Projects/Floorp/releases/download/v${pkgver}/floorp-${pkgver}.linux-${arch}.tar.bz2")
source_aarch64=("https://github.com/Floorp-Projects/Floorp/releases/download/v${pkgver}/floorp-${pkgver}.linux-${arch}.tar.bz2")
md5sums=('c12cf6c807ad562188e648c60b2b7289'
            'cecce3f030f194da95819cfaffe020e3')
md5sums_x86_64=('SKIP')
md5sums_aarch64=('SKIP')

package() {
  cd "${srcdir}/${_pkgname}"
  install -Ddvm755 "${pkgdir}/usr/lib/${_pkgname}"
  cp -rfv ./* "${pkgdir}/usr/lib/${_pkgname}/"
  cd "${srcdir}"
  mkdir -p "${pkgdir}/usr/share/icons/hicolor/128x128/apps"
  convert -resize 128x128 "Creater_pack_Floorp/Floorp_imgs/Floorp_Legacy/png/icons.png" "${pkgdir}/usr/share/icons/hicolor/128x128/apps/${_pkgname}.png"
  chmod 644 "${pkgdir}/usr/share/icons/hicolor/128x128/apps/${_pkgname}.png"
  mkdir -p "${pkgdir}/usr/share/icons/hicolor/256x256/apps"
  convert -resize 256x256 "Creater_pack_Floorp/Floorp_imgs/Floorp_Legacy/png/icons.png" "${pkgdir}/usr/share/icons/hicolor/256x256/apps/${_pkgname}.png"
  chmod 644 "${pkgdir}/usr/share/icons/hicolor/256x256/apps/${_pkgname}.png"
  mkdir -p "${pkgdir}/usr/share/icons/hicolor/512x512/apps"
  convert -resize 512x512 "Creater_pack_Floorp/Floorp_imgs/Floorp_Legacy/png/icons.png" "${pkgdir}/usr/share/icons/hicolor/512x512/apps/${_pkgname}.png"
  chmod 644 "${pkgdir}/usr/share/icons/hicolor/256x256/apps/${_pkgname}.png"
  install -Dvm644 "Creater_pack_Floorp/Floorp_imgs/Floorp_Legacy/svg/icons.svg" "${pkgdir}/usr/share/icons/hicolor/scalable/apps/${_pkgname}.svg"
  install -Dvm644 "${_pkgname}.desktop" "${pkgdir}/usr/share/applications/${_pkgname}.desktop"
  install -Dvm755 /dev/stdin "${pkgdir}/usr/bin/${_pkgname}" << END
#!/bin/sh
exec /usr/lib/${_pkgname}/${_pkgname} "\$@"
END
}
